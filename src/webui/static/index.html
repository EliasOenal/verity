<!DOCTYPE html>
<html>
<head>
  <title>Verity</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link href="vera.svg" rel="icon" type="image/png" />
  <link href="bootstrap.min.css" rel="stylesheet" />
  <link href="bootstrap-icons.min.css" rel="stylesheet" />
  <link href="manifest.json" rel="manifest" />
  <script src="bootstrap.bundle.min.js"></script>
  <script src="frontend.js" defer></script>
  <script src="verityUI.js" defer></script>
  <script>
    // This script tag prevents a flash of unstyled content (FOUC) on page load
    // and should not be moved.
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      document.documentElement.setAttribute('data-bs-theme', 'dark');
    }
  </script>
  <style>@import url('style.css');</style>
</head>

<body>
  <div class="content-wrapper">
    <div class="container-fluid">
      <div class="row" id="globalrow">
        <!-- Hamburger menu (top left) -- only visible on small screens -->
        <button id="leftnavCollapseToggler"
                class="navbar-toggler d-sm-none navbar-toggler-icon"
                type="button" data-bs-toggle="collapse"
                data-bs-target="#leftnavCollapsible">
        </button>
        <!-- Light/dark theme switch (top right) -- always visible -->
        <button class="btn btn-link dark-mode-toggle fade-in"
                id="verityThemeSwitch" onclick="toggleDarkMode()" type="button">
          <span id="theme-icon">
            <!-- The icon will be set here by the updateIcon function -->
          </span>
        </button>

        <!-- Main navigation column including Vera logo -->
        <div class="col-sm-3" id="verityLeftnav">
          <div id="veraNest" class="hidden">  <!-- will fade in through js -->
            <img src="vera.svg" class="img-fluid vera-anim vera-spin veraLogo"
              id="veralogo" alt="" onclick="veraRoll()" />
          </div>

          <!-- leftnavCollapsible (navigation, identity and peers)
               default collapsed on mobile view
          -->
          <div id="leftnavCollapsible" class="collapse navbar-collapse d-sm-block">
            <ul id="toplevelnav" class="navbar-nav my-5">
              <li class="nav-item" id="navPostsAll">
                <a href="#" class="nav-link"
                  onclick="window.verityUI.nav.navPostsAll()">
                    All posts
                </a>
              </li>
              <li class="nav-item" id="navPostsWithAuthors">
                <a href="#" class="nav-link"
                  onclick="window.verityUI.nav.navPostsWithAuthors()">
                    No anonymous posts
                </a>
              </li>
              <li class="nav-item" id="navPostsSubscribedInTree">
                <a href="#" class="nav-link"
                  onclick="window.verityUI.nav.navPostsSubscribedInTree()">
                    Subscribed (anywhere in thread)
                </a>
              </li>
              <li class="nav-item" id="navPostsSubscribedReplied">
                <a href="#" class="nav-link"
                  onclick="window.verityUI.nav.navPostsSubscribedReplied()">
                    Subscribed (+preceding)
                </a>
              </li>
              <li class="nav-item" id="navPostsSubscribedStrict">
                <a href="#" class="nav-link"
                  onclick="window.verityUI.nav.navPostsSubscribedStrict()">
                    Subscribed (strict)
                </a>
              </li>
              <li class="nav-item" id="navPostsSubscribedReplied1">
                <a href="#" class="nav-link"
                  onclick="window.verityUI.nav.navPostsSubscribedReplied(1)">
                    Subscribed (+preceding+WOT1)
                </a>
              </li>
              <li class="nav-item" id="navPostsSubscribedReplied3">
                <a href="#" class="nav-link"
                  onclick="window.verityUI.nav.navPostsSubscribedReplied(3)">
                    Subscribed (+preceding+WOT3)
                </a>
              </li>
              <li class="nav-item" id="navCubeExplorer">
                <a href="#" class="nav-link"
                  onclick="window.verityUI.nav.navCubeExplorer()">
                    Cube Explorer
                </a>
              </li>
            </ul>

            <div id="verityIdentityArea">
              <div class="verityIdentityRow">
                <div class="verityMyProfilePicArea">
                  <img src="unknownuser.svg" alt="" height="100%"
                      class="verityMyProfilePic" id="verityMyProfilePic" />
                </div>
                <div class="verityMyIdentityInfoArea">
                  <div class="verityNotLoggedIn">
                    <b class="verityLoadingPlaceholder">Loading...</b><br />
                    <a class="verityLoadingPlaceholder" href="#" onclick="window.verityUI.identityController.showLoginForm()">
                      Please wait
                    </a>
                  </div>
                </div>
              </div>

            </div> <!-- identityrow-->

            <div class="row my-4" id="verityOnlineStatusArea">
              <a class="verityOnlineStatus" href="#" onclick="window.verityUI.nav.navPeers()">
                <span class="redDot"></span>Offline
              </a>
            </div>
          </div> <!-- leftnavCollapsible -->
        </div> <!-- leftnav -->

        <div class="col-sm-8 container-fluid" id="verityContentCol">
          <div id="verityBackArea" class="mt-3 mt-sm-5 me-2" style="display: none"> <!-- will be shown as necessary by JS -->
            <a href="#" id="verityBackButton" class="bi bi-arrow-left"
               onclick="window.verityUI.nav.closeCurrentController()"></a>
          </div>
          <div id="verityContentArea"></div>
        </div> <!-- verityContentCol -->
      </div> <!-- globalrow -->
    </div> <!-- container-fluid -->
  </div> <!-- content-wrapper -->




  <!-- END OF FRAMEWORK-->
  <!-- Next up are templates -->
  <!-- These will be cloned as needed by the various Views -->
  <template id="verityPostViewTemplate">
    <div class="verityPostView">
      <div class="verityNewPostDiv mt-3 mt-sm-5 mb-3">
        <form id="verityNewPostForm" class="form-floating row" action="javascript:void(0);"
          onsubmit="window.verityUI.currentController.makeNewPost(this);">
          <textarea id="verityNewPostInput" class="form-control verityPostInput"
                    maxlength="600" rows="2" placeholder="Make new post"
                    oninput="window.onTextareaInput(this)" required></textarea>
          <label class="form-label" for="verityNewPostInput">Make new post</label>
          <button class="btn btn-primary" type="submit" id="newcube">Post</button>
        </form>
        <div class="progress bg-danger verityPostCharCountBarContainer" role="progressbar">
          <div class="progress-bar bg-success verityPostCharCountBar" style="width: 100%">
          </div>
          <div class="verityPostRemainingChars" style="display: none;">600</div>
        </div>
      </div>

      <div class="row" id="verityPostsRow">
        <ul class="verityPostList list-unstyled">
          <li class="verityPost move-fade-in"
          data-cubekey="<cubekey>" data-timestamp="1695048919">
            <div class="verityPostHeader">
              <img class="verityPostProfilePic" src="" />
              <p>
                <b class="verityCubeAuthor" title="MUC key <muckey>" id="<cubekey>-author">
                  User name
                </b>
                <button type="button"
                        class="btn btn-outline-primary veritySubscribeButton"
                        data-authorkey="<muckey>"
                        onclick="window.verityUI.currentController.subscribeUser(this)">
                  Subscribe
                </button>
                <br />
                <small class="verityPostDate">
                  Friday, September 15, 2023 6:22:12 PM
                </small>
              </p>
            </div>
            <p class="verityPostContent" title="Cube Key <cubekey>">Text</p>
            <div class="verityReplyDiv">
              <form action="javascript:void(0);"
                    onsubmit="window.verityUI.currentController.makeNewPost(this);"
                    class="verityReplyForm input-group">
                <textarea maxlength="600" class="form-control verityPostInput"
                          rows="1" type="text" required
                          placeholder="Reply" id="verityReplyInput-<cubekey>"
                          oninput="window.onTextareaInput(this)"></textarea>
                <button type="submit" class="btn btn-primary verityPostButton"
                        id="replybutton-<cubekey>">
                  Post
                </button>
              </form>
              <div class="progress bg-danger verityPostCharCountBarContainer"
                   role="progressbar">
                <div class="progress-bar bg-success verityPostCharCountBar"></div>
                <div class="verityPostRemainingChars" style="display: none;">600</div>
              </div>
            </div> <!-- verityReplyDiv-->
        </li>
        </ul>
      </div> <!-- verityPostsRow -->
    </div> <!-- verityPostView -->
  </template> <!-- verityPostViewTemplate -->




  <!-- Identity related templates -->
  <template id="verityIdentityRowTemplate">
    <div class="verityIdentityRow">
      <div class="verityMyProfilePicArea">
        <img src="unknownuser.svg" alt="" height="100%"
            class="verityMyProfilePic" id="verityMyProfilePic" />
      </div>
      <div class="verityMyIdentityInfoArea">
        <div class="verityNotLoggedIn">
          <b>Not logged in</b><br />
          <a href="#" onclick="window.verityUI.nav.navLogin()">
            Log in
          </a>
        </div>
        <div class="verityMyIdentityInfo">
          <b class="verityMyIdentityDisplayname">Usor probus veritatem tuendus</b><br />
          <a href="#" onclick="window.verityUI.nav.navEditIdentity()">
            Edit
          </a> · <a href="#" onclick="window.verityUI.identityController.logOut()">
            Logout
          </a>
        </div>
      </div>
    </div>
  </template>

  <template id="verityLoginFormTemplate">
    <div class="verityLoginFormView">
      <h2 class="mt-3 mt-sm-5 mb-3">Log in / Register</h2>
      <p>Log back into your account -- or create a new one!</p>
<!--
      <p>Todo: Put some useful text for the user here.</p>
      <p>Login and registration are almost the same technically,
         but we should still separate them for the sake of user experience.
         "Log in" should not automatically sculpt a new independent MUC, thus
         dropping all of the user's previous account data.
      </p>
      <p>
        Give the user some stern warnings regarding their password: You can
        never change it, and if you lose it your account is gone forever.
      </p>
      <p>
        Provide some account recovery options to the user, e.g. QR code,
        a list of secret words, whatever.
      </p>
      <p>
        Maybe use tabs to provide a choice of different log in experiences.
        There's the QR codes and secret word lists again.
      </p>
      <p>
        Maybe put this whole form in a modal dialogue?
      </p>
-->
      <form action="javascript:void(0);"
            onsubmit="window.verityUI.identityController.performLogin(this);">
      <div class="form-floating my-2">
        <input class="form-control form-control-sm verityUsernameInput"
              type="text" id="verityLoginUsername"
              placeholder="Username" autocomplete="username" name="id" required />
        <label for="verityLoginUsername">Username</label>
      </div>
      <div class="form-floating my-2">
        <input class="form-control form-control-sm verityPasswordInput"
               type="password" autocomplete="current-password"
               id="verityLoginPassword" placeholder="Password" required />
        <label for="verityLoginPassword">Password</label>
      </div>
      <button class="btn btn-primary my-2" type="submit">Login / Register</button>
    </form>
      <p class="verityLoginErrorMessage">
        <!-- loginFormView will place an error message here when applicable -->
      </p>
    </div>
  </template>

  <template id="verityEditIdentityTemplate">
    <div class="verityEditIdentityView">
      <h2 class="mt-3 mt-sm-5 mb-3">That's me</h2>
      <form action="javascript:void(0);"
            onsubmit="window.verityUI.identityController.performEditIdentity(this);">
      <div class="input-group my-2">
        <span class="input-group-text" id="verityEditIdentityDisplayNameDesc">
          Display name
        </span>
        <input class="form-control form-control-sm verityDisplayNameInput"
               type="text" id="verityEditDisplayName" aria-label="Display name"
               aria-describedby="verityEditIdentityDisplayNameDesc"
               required />
      </div>
      <div class="verityEditIdentityAvatarArea">
        <img src="unknownuser.svg" alt=""
             class="verityEditIdentityAvatar" />
        <input type="hidden" class="verityEditIdentityAvatarSeed" value="" />
        <button class="btn btn-primary mx-3" type="button"
                onclick="window.verityUI.identityController.randomMultiavatar()">
          Get me a different avatar
        </button>
      </div>
      <button class="btn btn-primary my-5 mx-3" type="submit">Save</button>
    </form>
    </div>
  </template>
  <!-- End of Identity related templates-->



  <template id="verityPeerViewTemplate">
    <div class="verityPeerView">
      <h5 class="mt-3 mt-sm-5 mb-3">Peers</h5>
      <p class="verityMyIdParagraph">My peer ID:
        <span class="verityMyId">01234567890ABCDEF</span>
      </p>
      <p class="form-check form-switch">
        <input class="verityAutoConnectSwitch form-check-input"
               type="checkbox" role="switch"
               onclick="window.verityUI.peerController.toggleAutoConnect(this)"
               checked />
        Auto-connect peers
      </p>
      <div class="verityNewPeerDiv">
        <form class="verityNewPeerForm input-group"
              action="javascript:void(0);"
              onsubmit="window.verityUI.peerController.connectPeer(this);">
          <div class="form-floating">
            <input id="verityNewPeerInput" class="form-control verityNewPeerInput"
                   maxlength="600" placeholder="New peer address" required />
            <label class="form-label" for="verityNewPeerInput">New peer address</label>
          </div>
          <button class="btn btn-primary verityNewPeerButton" type="submit">
            Connect
          </button>
        </form>
      </div>

      <ul class="nav nav-tabs verityPeerTypeNav">
        <li class="nav-item verityPeerTypeNavItem">
          <a class="nav-link verityPeerTypeNavLink active" href="#"
             data-verityShallDisplay="1"
             onclick="window.verityUI.currentController.changeDisplayTo(1)">
            Connected
          </a>
        </li>
        <li class="nav-item verityPeerTypeNavItem">
          <a class="nav-link verityPeerTypeNavLink" href="#"
            data-verityShallDisplay="2"
             onclick="window.verityUI.currentController.changeDisplayTo(2)">
            Exchangeable
          </a>
        </li>
        <li class="nav-item verityPeerTypeNavItem">
          <a class="nav-link verityPeerTypeNavLink" href="#"
            data-verityShallDisplay="3"
             onclick="window.verityUI.currentController.changeDisplayTo(3)">
            Verified
          </a>
        </li>
        <li class="nav-item verityPeerTypeNavItem">
          <a class="nav-link verityPeerTypeNavLink" href="#"
            data-verityShallDisplay="4"
             onclick="window.verityUI.currentController.changeDisplayTo(4)">
            Unverified
          </a>
        </li>
      </ul>

      <ul class="verityPeerList">
        <li class="verityPeer card move-fade-in">
          <table class="table card-body verityPeerTable">
            <tr class="verityPeerDataRow">
              <th class="verityPeerDataHeader">ID</th>
              <td class="verityPeerData verityPeerId">
                e66c51d5130992aac3be542a5df17996
              </td>
            </tr>
            <tr class="verityPeerDataRow">
              <th class="verityPeerDataHeader">Connected through</th>
              <td class="verityPeerData verityPeerConn">
                ws://verity.hahn.mt:1984/
              </td>
            </tr>
            <tr class="verityPeerDataRow">
              <th class="verityPeerDataHeader">Status</th>
              <td class="verityPeerData verityPeerTransmissionStatus">OK</td>
            </tr>
            <tr class="verityPeerDataRow">
              <th class="verityPeerDataHeader">Known addresses</th>
              <td class="verityPeerData verityPeerAddresses">
                <ol class="verityPeerAddressList">
                  <li value="0">ws://demonstration.address <br />
                    <button type="button" data-peerid="e66c51d5130992aac3be542a5df17996"
                    data-addrindex="1" class="veritySmallButton btn btn-outline-primary active"
                    onclick="window.verityUI.peerController.makeAddressPrimary(this)">
                      Primary
                    </button>
                  </li>
                  <li value="1">/dns4/demonstration.address/tcp/1985/wss/ <br/>
                    <button type="button" data-peerid="e66c51d5130992aac3be542a5df17996"
                    data-addrindex="1" class="veritySmallButton btn btn-outline-primary"
                    onclick="window.verityUI.peerController.makeAddressPrimary(this)">
                      Primary
                    </button>
                  </li>
                </ol>
              </td>
            </tr>
          </table>
          <p>
            <button class="verityPeerReconnectButton btn btn-warning"
                    data-peerid="e66c51d5130992aac3be542a5df17996"
                    onclick="window.verityUI.peerController.disconnectPeer(this, true)">
              Reconnect
            </button>
            <button class="verityPeerDisconnectButton btn btn-danger"
                    data-peerid="e66c51d5130992aac3be542a5df17996"
                    onclick="window.verityUI.peerController.disconnectPeer(this)">
              Disconnect
            </button>
          </p>
        </li>
      </ul>
    </div>
  </template> <!-- verityPeerViewTemplate -->



  <template id="verityCubeExplorerTemplate">
    <div class="verityCubeExplorer">
      <h2 class="mt-3 mt-sm-5 mb-3">CCI Cube explorer</h2>
      <form class="my-4 form-floating" action="javascript:void(0);"
            onsubmit="window.verityUI.cubeExplorerController.redisplay();">
        <div class="input-group">
          <span class="input-group-text" id="verityCubeKeyFilterDesc">
            Cube Key
          </span>
          <input class="form-control form-control-sm verityCubeKeyFilter"
                 type="text" id="verityCubeKeyFilter" aria-label="Cube Key"
                 aria-describedby="verityCubeKeyFilterDesc" />
          <button class="btn btn-primary" type="submit">Filter</button>
        </div>
      </form>
      <table class="table verityCubeStats">
        <tr>
          <th>Total Cubes stored</th>
          <td class="verityCubeStoreStatTotalCubes">31337</td>
        </tr>
        <tr>
          <th>– not matching filter</th>
          <td class="verityCubeStoreStatCubesFiltered">over 9000</td>
        </tr>
        <tr>
          <th>– unparsable / non-CCI Cubes</th>
          <td class="verityCubeStoreStatCubesUnparsable">over 9000</td>
        </tr>
        <tr class="table-light">
          <th>= Cubes displayed</th>
          <td class="verityCubeStoreStatCubesDisplayed">1337</td>
        </tr>
      </table>

      <ul class="verityCubeList accordion" id="verityExploredCubes">
        <li class="verityCube accordion-item"
            data-cubekey="44ef229784f42e86fdfa6e7b7b57157d05b47eb1373d5c1c1e36201376441000">
          <h5 class="accordion-header">
            <button class="accordion-button verityCubeToggleControl verityCubeSummary collapsed"
                    type="button" data-bs-toggle="collapse" aria-expanded="false"
                    data-bs-target="#verityExploredCube-44ef229784f42e86fdfa6e7b7b57157d05b47eb1373d5c1c1e36201376441000"
                    aria-controls="verityExploredCube-44ef229784f42e86fdfa6e7b7b57157d05b47eb1373d5c1c1e36201376441000">
              44ef229784f42e86fdfa6e7b7b57157d05b47eb1373d5c1c1e36201376441000
            </button>
          </h5>
          <div id="verityExploredCube-44ef229784f42e86fdfa6e7b7b57157d05b47eb1373d5c1c1e36201376441000"
               class="accordion-collapse collapse verityExploredCube"
               data-bs-parent="#verityExploredCubes">
            <div class="accordion-body">
              <table class="table verityCubeInfo">
                <tr>
                  <th>Cube type</th>
                  <td class="verityCubeType">Frozen</td>
                </tr>
                <tr>
                  <th>Hash</th>
                  <td class="verityCubeHash">44ef229784f42e86fdfa6e7b7b57157d05b47eb1373d5c1c1e36201376441000</td>
                </tr>
                <tr>
                  <th>Date</th>
                  <td class="verityCubeDate">Tuesday, February 6, 2024 1:01:04 PM</td>
                </tr>
                <tr>
                  <th>Difficulty</th>
                  <td class="verityCubeDifficulty">42</td>
                </tr>
              </table>
              <!-- Schematic Cube view-->
              <ul class="veritySchematicFields nav nav-pills mb-3" role="tablist"
                  id="pills-tab-44ef229784f42e86fdfa6e7b7b57157d05b47eb1373d5c1c1e36201376441000">
                <li class="nav-item" role="presentation">
                  <button class="nav-link border border-primary rounded me-1 mb-1 veritySchematicField"
                          type="button"
                          role="tab" data-bs-toggle="pill" aria-selected="false"
                          id="pills-tab-44ef229784f42e86fdfa6e7b7b57157d05b47eb1373d5c1c1e36201376441000-0"
                          data-bs-target="#pills-44ef229784f42e86fdfa6e7b7b57157d05b47eb1373d5c1c1e36201376441000-0"
                          aria-controls="pills-44ef229784f42e86fdfa6e7b7b57157d05b47eb1373d5c1c1e36201376441000-0">
                    Version
                  </button>
                </li>
              </ul>
              <div class="tab-content veritySchematicFieldDetailsContainer" id="pills-tabContent">
                <table class="tab-pane fade veritySchematicFieldDetails table"
                       id="pills-44ef229784f42e86fdfa6e7b7b57157d05b47eb1373d5c1c1e36201376441000-0"
                       role="tabpanel"
                       aria-labelledby="pills-tab-44ef229784f42e86fdfa6e7b7b57157d05b47eb1373d5c1c1e36201376441000-0"
                       data-fieldindex="1">
                  <tr class="veritySchematicFieldDetails">
                    <th>Type</th>
                    <td class="veritySchematicFieldType">VERSION</td>
                  </tr>
                  <tr>
                    <th>Start index</th>
                    <td class="veritySchematicFieldStart">1337</td>
                  </tr>
                  <tr>
                    <th>Content length</th>
                    <td class="veritySchematicFieldLength">31337</td>
                  </tr>
                  <tr>
                    <th>Content<br />
                      <select name="verityContentEncodingSwitch"
                              class="verityContentEncodingSwitch"
                              oninput="window.verityUI.currentController.changeEncoding(this)">
                        <option value="utf8">UTF-8</option>
                        <option value="utf16">UTF-16</option>
                        <option value="hex">Hex</option>
                      </select>
                    </th>
                    <td class="veritySchematicFieldContent">
                      0xcafebabe
                    </td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </li>
      </ul>
      <div class="verityMessageBottom"></div>
    </div>
  </template> <!-- verityCubeExplorerTemplate -->


</body>

</html>